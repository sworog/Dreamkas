<% var templates = {
    form_barcodes__row: require('tpl!blocks/form/form_barcodes/form_barcodes__row.html')
} %>

<% var Page = require('kit/page/page') %>

<div class="content">
    <h1>Дополнительные штриховые коды</h1>

    <div id="barcodesTable" class="table" style="margin-bottom: 30px;">
        <div class="table__head">
            <div class="table__row">
                <div class="table__cell">Штрихкод</div>
                <div class="table__cell" style="width: 1px;">Количество</div>
                <div class="table__cell" style="width: 1px;">Цена по ШК</div>
                <div class="table__cell" style="width: 1px;"></div>
            </div>
        </div>

        <form id="form_barcodes" class="form form_barcodes table__body">
            <% Page.current.models.product.collections.barcodes.forEach(function(barcodeModel){ %>
                <%= templates.form_barcodes__row({
                    barcodeModel: barcodeModel
                }) %>
            <% }) %>
        </form>
        <% if (LH.isAllow('products', 'PUT::{product}/barcodes')) { %>
        <form class="form form_barcode table__body">
            <div class="table__row">
                <div class="table__cell">
                    <input autofocus name="barcode" type="text" class="inputText"/>
                </div>
                <div class="table__cell">
                    <input name="quantity" type="text" value="1" class="inputText" style="width: 80px;"/>
                </div>
                <div class="table__cell" style="white-space: nowrap">
                    <input name="price" type="text" class="inputText" style="width: 100px; text-align: right"/>
                    <span>руб.</span>
                </div>
                <div class="table__cell">
                    <button type="submit" class="button">Добавить</button>
                </div>
            </div>
        </form>
        <% } %>
    </div>
    <% if (LH.isAllow('products', 'PUT::{product}/barcodes')) { %>
    <div class="form__controls">
        <button form="form_barcodes" class="button" type="submit">
            Сохранить
        </button>
        <span style="margin-right: 5px;">
            или
        </span>
        <a href="/products/<%- models.product.id %>">Отменить</a>
    </div>
    <% } %>
</div>
